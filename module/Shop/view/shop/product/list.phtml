<?php $this->headTitle('Products') ?>
<?php echo $this->ztbFlashMessenger()->render(); ?>

<?php if (count($this->models) > 0): ?>

<table id="product-list" class="table table-hover table-bordered table-condensed sortable-table">
	<thead>
		<tr>
		    <th data-field="enabled">&nbsp;</th>
			<th data-field="productId">Product Id</th>
			<th data-field="name">Name</th>
			<th data-field="description">Description</th>
			<th data-field="price">Price</th>
			<th data-field="group">Group</th>
			<th data-field="category">Category</th>
			<th data-field="dateCreated">Date Created</th>
			<th data-field="dateModified">Date Modified</th>
			<th>Actions</th>
		</tr>
	</thead>
	
	<tbody>
		<?php foreach($this->models as $row): ?>
		<tr>
		    <td><?=$this->enabled($row, array(
		    	'table' => 'product',
		        'route' => 'admin/shop/product/edit',
		    )); ?></td>
			<td><?=$this->escapeHtml($row->getProductId()); ?></td>
			<td><?=$this->escapeHtml($row->getName()); ?></td>
			<td><?=$this->escapeHtml($row->getShortDescription()); ?></td>
			<td><?=$this->priceFormat($row->getPrice()); ?>
			<td><?=$this->escapeHtml($row->getGroup()); ?>
			<td><?=$this->escapeHtml($row->getCategory()); ?></td>
			<td><?=$this->escapeHtml($this->formatDate($row->getDateCreated())); ?></td>
			<td><?=$this->escapeHtml($this->formatDate($row->getDateModified())); ?></td>
			<td>
                <a href="<?=$this->url('admin/shop/product/edit', array(
                    'id' => $row->getProductId()
				)); ?>" class="btn">Edit</a>
				&nbsp;
				
				<!-- Button to trigger modal -->
                <a href="#productModel<?=$row->getProductId();?>" class="btn btn-danger" data-toggle="modal">Delete</a>
                <!-- Modal -->
				<div class="modal hide fade" id="productModel<?=$row->getProductId(); ?>">
				  <div class="modal-header">
				    <button type="button" class="close" data-dismiss="modal">&times;</button>
				    <h3 id="productModel<?=$row->getProductId(); ?>Label">Warning</h3>
				  </div>
				  <form class="form-horizontal"  method="post" action="<?=$this->url('admin/shop/product/edit', array(
				        'action' => 'delete',
				    )) ?>">
				        <div class="modal-body">
				            <p>Are you sure you want to delete this product.</p>
				            <p class="label label-important">This action cannot be undone</p>
				        </div>
				        <input type="hidden" name="productId" value="<?=$row->getProductId() ?>">
				        <div class="modal-footer">
				            <button type="button" class="btn btn-primary" data-dismiss="modal">No Don't Do It</button>
				            <button type="submit" name="submit" class="btn btn-danger" value="delete">Yes Delete It</button>
				        </div>
				    </form>
				</div>
			</td>
		</tr>
		<?php endforeach; ?>
	</tbody>
</table>

<?=$this->paginationControl(
    $this->models,
    'Elastic',
    'paginate',
	array('route' => 'admin/shop/product/page')
); ?>

<?php else: ?>
<h4>No Products where returned by search.</h4>
<?php endif; ?>